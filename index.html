<input type="file" id="fileInput">
<br>
<button onclick="addWatermark()">Aggiungi filigrana</button>
<br>
<canvas id="canvas"></canvas>
<a id="downloadButton" download="immagine_con_filigrana.png">Scarica immagine</a>
<style>
    canvas {
        border: 1px solid black;
    }
</style>
<script>
    function addWatermark() {
        // ottieni il canvas e il contesto di disegno
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");

        // ottieni l'immagine caricata dall'utente
        var fileInput = document.getElementById("fileInput");
        var image = new Image();
        image.onload = function() {
            canvas.width = image.width; // corretto
            canvas.height = image.height; // corretto
            ctx.drawImage(image, 0, 0, image.width, image.height);

            // carica la filigrana e disegnala sul canvas
            var watermark = new Image();
            watermark.src = "images/ginopinooooooo.png";
            watermark.onload = function() {
                ctx.globalAlpha = 0.7;
                ctx.drawImage(watermark, 0, 0, watermark.width, watermark.height, 0, 0, image.width, image.height);
                // aggiorna il link per il download dell'immagine
                var downloadButton = document.getElementById("downloadButton");
                downloadButton.href = canvas.toDataURL("image/png");
            }
        };
        // Correzione del metodo createObjectURL
        image.src = URL.createObjectURL(fileInput.files[0]); // corretto
    }
</script>
